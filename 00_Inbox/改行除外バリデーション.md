---
date: 2026-01-22 21:08
tags:
  - TIL
  - Status/書きかけ
  - Rails
  - validation
---
# 改行除外バリデーション

## 💡 学んだこと・解決した課題
改行をバリデーションで除外する方法
## 📝 詳細・原因
- Ruby（やOS）では改行コードが複数存在する。`\n`（LF）だけでなく、`\r\n`（CRLF）や `\r`（CR）などがあり、`\n` だけを弾くと環境によって改行を検知できないケースがある。
- `\R` は Ruby の正規表現において「**あらゆる改行コード**」を表すメタ文字で、  
LF / CRLF / CR などをまとめて検知できる。
- `form.text_field`の時点で改行を送ることはできない
- バリデーションをテストしたい時は一時的に`text_area`してやること
## 💻 解決策・コード
```ruby
validates :name, format: { without: /\R/, message: "に改行は使えません" }
```

## 🔗 参考リンク
- https://docs.ruby-lang.org/ja/latest/doc/spec=2fregexp.html
- https://railsguides.jp/active_record_validations.html#format
- https://ja.wikipedia.org/wiki/%E6%94%B9%E8%A1%8C%E3%82%B3%E3%83%BC%E3%83%89
## 💭 感想・次への課題
- 改行は`\n`だけでなく複数あると初めて知った
- `\R`を使えば、環境さに対応出来ると学んだ